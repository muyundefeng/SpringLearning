package com.appCrawler.pagePro;


import java.util.List;

import com.appCrawler.pagePro.apkDetails.Ijiaa_Detail;

import us.codecraft.webmagic.Apk;
import us.codecraft.webmagic.Page;
import us.codecraft.webmagic.Site;
import us.codecraft.webmagic.processor.PageProcessor;
import us.codecraft.webmagic.selector.Html;
import us.codecraft.webmagic.utils.PostSubmit;

/**
 * i+a
 * 网站主页：http://www.ijiaa.com/
 * @id 532
 * @author lisheng
 */
public class Ijiaa implements PageProcessor{
	Site site = Site.me().setCharset("utf-8").setRetryTimes(2).setSleepTime(3);
	//private static int flag=1;
	@Override
	public Apk process(Page page) {
	
		if(page.getUrl().regex("http://www\\.ijiaa\\.com/game.*").match())
		{
	 		List<String> apps=null;
	 		String count=page.getHtml().xpath("//div[@class='count']/span[2]/span[@id='LabCountPage']/text()").toString();
	 		int countNum=Integer.parseInt(count);
	 		for(int i=1;i<=countNum;i++)
	 		{	
	 			String params="__EVENTTARGET=plink"+i+"&__EVENTARGUMENT=&__VIEWSTATE=%2FwEPDwUKMTQ1NDI1Mzg5OQ9kFgICAw9kFiICAQ9kFgYCAQ8PFgQeBFRleHQFUg0KICAgICAgICAgICAgPGRpdiBjbGFzcz0ibGluayI%2BDQogICAgICAgICAgICAgICAg5bi46KeB6Zeu6aKYPC9kaXY%2BDQogICAgICAgICAgICAeC05hdmlnYXRlVXJsBSRodHRwOi8vd3d3LmlqaWFhLmNvbS9hYm91dC5odG1sP2lkPTFkZAIFD2QWAmYPDxYKHgVXaWR0aBsAAAAAAAB%2BQAEAAAAeBkhlaWdodBsAAAAAAIBTQAEAAAAeCEltYWdlVXJsBS5odHRwOi8vd3d3LmlqaWFhLmNvbS9zb2Z0LzIwMTUxMTIwMTEzNDg5NjguanBnHg1PbkNsaWVudENsaWNrBTh3aW5kb3cub3BlbignaHR0cDovL2lqaWFhLmNvbS9zb2Z0X2RldGFpbC5odG1sP2lkPTc1NScpOx4EXyFTQgKAA2RkAgkPFgIeBWNsYXNzBQlnZF9idG5fb25kAhUPZBYCAgEPFgIeC18hSXRlbUNvdW50AggWEGYPZBYCZg8VDgM3MjQ1aHR0cDovL2FwcGQuMTIzLnNvZ291LmNvbS91LzIwMTQvMDQvNTM1MGYyOGUwOWY2OC5wbmcDNzI0DzNE57uI5p6B54uC6aOZMwUyNDUzNpcBPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0naHN0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgM3MjQPM0Tnu4jmnoHni4Lpo5kzPOOAijNE57uI5p6B54uC6aOZM%2BOAi%2BesrOS4ieS7o%2BWNjuS4veadpeiire%2B8jOW8uuWKv%2BeZu%2BmZhu%2B8gQblhY3otLmXATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2hzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdnc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4KMjAxNS0wOS0xNAY3LjcyTUIDNzI0ZAIBD2QWAmYPFQ4DNzE1LWh0dHA6Ly93d3cuaWppYWEuY29tL3NvZnQvMjAxNTY4MTU0MzI4MTA5LnBuZwM3MTUV6Jm%2B57Gz6Z%2Bz5LmQ5pKt5pS%2B5ZmoBjI4NDYxM5YBPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0naHN0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2NsZWFyYm90aCc%2BPC9kaXY%2BAzcxNRXomb7nsbPpn7PkuZDmkq3mlL7lmaha6Jm%2B57Gz6Z%2Bz5LmQ5piv5pyA5YW35pe25bCa5ZKM5ZOB5ZGz55qE6Z%2Bz5LmQ5bmz5Y%2Bw77yM5piv5YWo55CD5Y2O5Lq65aSn5ZKW55qE5YWx5ZCM6YCJ5oupBuWFjei0uZYBPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0naHN0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2NsZWFyYm90aCc%2BPC9kaXY%2BCjIwMTUtMDgtMjEEMTBNQgM3MTVkAgIPZBYCZg8VDgM3MzBfaHR0cDovL2FuZHJvaWQtYXJ0d29ya3MuMjVwcC5jb20vZnMwMS8yMDE1LzA1LzEyLzcvMTA5Xzc5NjViZDIxMTQwNjJjNTc1NDZmNmI5YzhiOGUxMDA4X2Nvbi5wbmcDNzMwD%2BW8gOW%2Fg%2Ba2iOa2iOS5kAc1MTY1NzM4lgE8ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdoc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4DNzMwD%2BW8gOW%2Fg%2Ba2iOa2iOS5kEnmuIXmlrDlj6%2FniLHnmoTpq5jmuIXnlLvotKjvvIxR6JCM5Y%2Bv54ix55qE5bCP5Yqo54mp5LusLi4u6ICB5bCR55qG5a6c77yBBuWFjei0uZYBPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0naHN0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2NsZWFyYm90aCc%2BPC9kaXY%2BCjIwMTUtMDUtMjkHMTUuNTNNQgM3MzBkAgMPZBYCZg8VDgM3MzFfaHR0cDovL2FuZHJvaWQtYXJ0d29ya3MuMjVwcC5jb20vZnMwMS8yMDE1LzA1LzEyLzIvMTA5XzI1YTMwODlkZmQ2YmQyZjY0OGYxMWQ1ZWJiZDUyNGEwX2Nvbi5wbmcDNzMxE%2BakjeeJqeWkp%2BaImOWDteWwuDIHMzU0NzAyNpYBPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0naHN0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2NsZWFyYm90aCc%2BPC9kaXY%2BAzczMRPmpI3nianlpKfmiJjlg7XlsLgyf%2BOAiuakjeeJqeWkp%2BaImOWDteWwuDLjgIvmmK%2FjgIrmpI3nianlpKfmiJjlg7XlsLjjgIvnmoTlhajmlrDnu63kvZzjgILlnKjmsr%2Fooq3kuobnu4%2FlhbjnmoTmpI3nianpmLLlvqHlg7XlsLjnjqnms5XnmoTln7rnoYDkuIoG5YWN6LS5lgE8ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdoc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4KMjAxNS0wNS0yOQc1NC42N01CAzczMWQCBA9kFgJmDxUOAzczMllodHRwOi8vYW5kcm9pZC1hcnR3b3Jrcy4yNXBwLmNvbS9mczAzLzIwMTUvMDMvMDMvNC8wXzI3ZGY5MjA5MzQ3NzBhNDI1OWI2YTRjMmRiMDA5M2Y4LnBuZwM3MzIM5aSp5aSp54Kr5paXBzg3MDkzMzaWATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgM3MzIM5aSp5aSp54Kr5paXmQHmuLjmiI%2FkuK3ni6zlhbfkuIDmoLznmoTmqKrniYjmiJjmlpfmqKHlvI%2FvvIzlj6%2Forqnnjqnlrrbkvb%2FnlKjmiYvmnLrovbvmnb7mhJ%2Flj5fmjozkuK3moLzmlpfnmoTmlrDkvZPpqozvvIzljY7kuL3nmoTmuLjmiI%2FmioDog73mkK3phY3mioDlt6fmgKfnmoTlh7rmi5sG5YWN6LS5lgE8ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdnc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4KMjAxNS0wNS0yOQcyNS4yNE1CAzczMmQCBQ9kFgJmDxUOAzY5MVtodHRwOi8vYW5kcm9pZC1hcnR3b3Jrcy4yNXBwLmNvbS9mczAzLzIwMTUvMDMvMTQvMS8xMDJfNDgxMjRjNTA5Mzc4NjI2MDdlMDQzM2ZiM2RjN2U2MjIucG5nAzY5MRfmnLrlnLrln44oQWlycG9ydCBDaXR5KQQyNTQzlgE8ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdnc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4DNjkxF%2BacuuWcuuWfjihBaXJwb3J0IENpdHkp3QHmnLrlnLrln44oQWlycG9ydCBDaXR5KeaYr%2BS4gOasvuetlueVpee7j%2BiQpeexu%2Ba4uOaIj%2B%2B8jOmhvuWQjeaAneS5ie%2B8jOeOqeWutuWcqOa4uOaIj%2BS4reWPr%2BS7pemaj%2BaEj%2BW7uumAoOiHquW3seWWnOeIseeahOmjnuacuuWcuu%2B8jOaOp%2BWItuaVsOeZvuaetuiIquePre%2B8jOS9nOS4uuacuuWcuueahOeuoeeQhuiAheeahOS9oOimgeS%2FruW7uumjnuacuuS7k%2BW6k%2BS7peWPiui3kemBkwblhY3otLmWATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgoyMDE1LTA1LTI5BzIzLjQ2TUIDNjkxZAIGD2QWAmYPFQ4DNjkyOmh0dHA6Ly9hbmRyb2lkLWFydHdvcmtzLjI1cHAuY29tLzc1LzEzMjY2NjdfMTM4MjM0ODM3Mi5wbmcDNjkyHuacgOWQjueahOmYsuW%2BoShGaW5hbCBEZWZlbmNlKQYzNDUyNTOWATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgM2OTIe5pyA5ZCO55qE6Ziy5b6hKEZpbmFsIERlZmVuY2UpggLlnKjmmK%2FkuIDlnLrnjrDku6PljJbnp5HmioDmiJjkuonvvIzmnIDlkI7nmoTpmLLlvqEoRmluYWwgRGVmZW5jZSnmuLjmiI%2FkuK3nu5PlkIjkuobkuJbnlYzlpKfmiJjkuozmiJjmnJ%2Fpl7Tog4zmma%2FjgILnsbvkvLzkuo7miqLmu6nnmbvpmYbmuLjmiI%2FvvIznjqnlrrblnKjmuLjmiI%2FkuK3mia7mvJTph43lnovngavlipvmnLrmnqrmiYvnmoTop5LoibLvvIznlKjmtLvlipvljovliLbmlYzkurrvvIzpmLLmraLmlYzkurrku47mtbfmu6nnmbvpmYbjgIIG5YWN6LS5lgE8ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdnc3Rhcic%2BPC9kaXY%2BPGRpdiBjbGFzcz0nY2xlYXJib3RoJz48L2Rpdj4KMjAxNS0wNS0yOQcxMS4xOU1CAzY5MmQCBw9kFgJmDxUOAzcyOV9odHRwOi8vYW5kcm9pZC1hcnR3b3Jrcy4yNXBwLmNvbS9mczA0LzIwMTUvMDQvMjAvNS8xMDlfM2RmN2U2ZThkNzc5Y2M5OGI0YjhiZDQyMjQwMzU5ODFfY29uLnBuZwM3MjkM5L%2Bd5Y2r6JCd5Y2cBzc1ODA0MjSWATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgM3MjkM5L%2Bd5Y2r6JCd5Y2cPOS4gOasvuWMheijheeyvue%2BjuOAgeecn%2Bato%2BWPr%2BeIseiMg%2BWEv%2BeahOi2heiQjOWhlOmYsua4uOaIjwblhY3otLmWATxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J3N0YXInPjwvZGl2PjxkaXYgY2xhc3M9J2dzdGFyJz48L2Rpdj48ZGl2IGNsYXNzPSdjbGVhcmJvdGgnPjwvZGl2PgoyMDE1LTA1LTI5BzU4Ljk4TUIDNzI5ZAIXDw8WAh8ABQE1ZGQCGQ8PFgIfAAUCNDVkZAIbDw8WBB8ABTs8ZGl2IGNsYXNzPSJidG4iIHN0eWxlPSJtYXJnaW4tbGVmdDogMTBweDsiPuesrOS4gOmhtTwvZGl2Ph4HRW5hYmxlZGdkZAIdDw8WBB8ABSA8ZGl2IGNsYXNzPSJidG4iPuS4iuS4gOmhtTwvZGl2Ph8JZ2RkAh8PDxYGHghDc3NDbGFzcwUGcGdfbnVtHwAFATEfBgICZGQCIQ8PFgYfCgUGcGdfbnVtHwAFATIfBgICZGQCIw8PFgYfCgUGcGdfbnVtHwAFATMfBgICZGQCJQ8PFgYfCgUGcGdfbnVtHwAFATQfBgICZGQCJw8PFgYfCgUJcGdfbnVtX29uHwAFATUfBgICZGQCKQ8PFgYfCgUGcGdfbnVtHwAFATYfBgICZGQCKw8PFgYfCgUGcGdfbnVtHwAFATcfBgICZGQCLQ8PFgYfCgUGcGdfbnVtHwAFATgfBgICZGQCLw8PFgYfCgUGcGdfbnVtHwAFATkfBgICZGQCMQ8PFgYfCgUGcGdfbnVtHwAFAjEwHwYCAmRkAj8PZBYCZg8PFgofAhsAAAAAAMByQAEAAAAfAxsAAAAAAEBvQAEAAAAfBAUvaHR0cDovL3d3dy5pamlhYS5jb20vc29mdC8yMDExMTEyNzIxMTYzOTI2MC5qcGcfBQUdd2luZG93Lm9wZW4oJ3d3dy5pamlhYS5jb20nKTsfBgKAA2RkGAEFHl9fQ29udHJvbHNSZXF1aXJlUG9zdEJhY2tLZXlfXxYCBRpjdHJsX3RvcDEkY3RybF9hZHMyJGltZ19hZAUQY3RybF9hZHMxJGltZ19hZIa32pBr9R7AhReIkj5GK7Z3FPSa&__VIEWSTATEGENERATOR=55D6206A&hd_class=&hd_order=1&hd_st=&ctrl_sch1%24txt_kw=";
	 			//page.addTargetRequest(url);
	 			Html html=Html.create(PostSubmit.postGetData("http://www.ijiaa.com/android.aspx", params));
	 			apps=html.links("//div[@class='sft_list']").all();
	 			for(String str:apps)
	 			{
	 				if(!str.contains("get_file"))
	 				{
	 					page.addTargetRequest("http://www.ijiaa.com/"+str);
	 				}
	 			}
	 		}
		}
		if(page.getUrl().regex("http://www\\.ijiaa\\.com/soft_detail\\.html\\?id=\\d+").match())
			{
				return Ijiaa_Detail.getApkDetail(page);
			}
			return null;
		
	}

	//@Override
	public Site getSite() {
		return site;
	}

	@Override
	public List<Apk> processMulti(Page page) {
		// TODO Auto-generated method stub
		return null;
	}

}
